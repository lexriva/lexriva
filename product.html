<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lexriva | My Bag</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --cherry: #72001A; --gold: #D4AF37; --lavender: #F9F7FF; }
        body { font-family: 'Inter', sans-serif; margin: 0; background: var(--lavender); padding-bottom: 120px; }
        
        .header { background: #fff; padding: 15px 20px; display: flex; align-items: center; border-bottom: 1px solid #eee; }
        .back-btn { font-size: 24px; color: var(--cherry); cursor: pointer; text-decoration: none; font-weight: 900; }
        .page-title { font-family: 'Cinzel'; font-size: 16px; font-weight: 900; color: var(--cherry); flex-grow: 1; text-align: center; }

        .bag-items { padding: 15px; }
        .item-card { background: #fff; border-radius: 15px; padding: 12px; display: flex; gap: 15px; margin-bottom: 12px; position: relative; }
        .item-card img { width: 80px; height: 100px; object-fit: cover; border-radius: 10px; }
        .item-info h4 { font-size: 13px; margin: 0 0 5px; color: #333; }
        .item-info p { font-size: 11px; color: #888; margin: 2px 0; }
        .item-price { font-weight: 800; color: var(--cherry); margin-top: 5px; }
        .remove-btn { position: absolute; top: 12px; right: 12px; color: #ccc; font-size: 18px; cursor: pointer; }

        .summary-box { background: #fff; margin: 15px; padding: 20px; border-radius: 20px; border: 1px dashed var(--gold); }
        .summary-row { display: flex; justify-content: space-between; font-size: 13px; margin-bottom: 10px; }
        .total-row { border-top: 1px solid #eee; padding-top: 10px; font-weight: 900; color: var(--cherry); font-size: 16px; }

        .form-box { background: #fff; margin: 15px; padding: 20px; border-radius: 20px; }
        .form-box h3 { font-family: 'Cinzel'; font-size: 14px; margin-bottom: 15px; color: var(--cherry); }
        input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #eee; border-radius: 10px; box-sizing: border-box; outline: none; }

        .order-btn { position: fixed; bottom: 20px; left: 20px; right: 20px; background: var(--cherry); color: #fff; padding: 18px; border: none; border-radius: 15px; font-weight: 800; font-size: 15px; cursor: pointer; box-shadow: 0 10px 20px rgba(114,0,26,0.2); }
    </style>
</head>
<body>

    <div class="header">
        <div class="back-btn" onclick="history.back()">←</div>
        <div class="page-title">SHOPPING BAG</div>
    </div>

    <div id="itemList" class="bag-items"></div>

    <div class="summary-box">
        <div class="summary-row"><span>Items Total</span><span id="subTotal">₹0</span></div>
        <div class="summary-row"><span>Shipping Charges</span><span id="shipCharge">₹0</span></div>
        <div class="summary-row" style="color: green; font-weight: 700;"><span>Delivery Time</span><span>7-8 Days</span></div>
        <div class="summary-row total-row"><span>Total Amount</span><span id="grandTotal">₹0</span></div>
    </div>

    <div class="form-box">
        <h3>DELIVERY ADDRESS</h3>
        <input type="text" id="custName" placeholder="Full Name">
        <input type="text" id="custPhone" placeholder="Phone Number">
        <input type="text" id="custAddress" placeholder="Full Address (House No, Area, City)">
        <input type="text" id="custPin" placeholder="Pincode">
        <div style="font-size: 10px; color: #888; margin-top: 5px;">* COD (Cash on Delivery) Available</div>
    </div>

    <button class="order-btn" onclick="placeOrder()">PLACE ORDER</button>

    <script>
        function loadBag() {
            let bag = JSON.parse(localStorage.getItem('lexBag')) || [];
            if(bag.length === 0) {
                document.getElementById('itemList').innerHTML = "<p style='text-align:center; padding:50px;'>Your bag is empty!</p>";
                return;
            }

            let subTotal = 0;
            document.getElementById('itemList').innerHTML = bag.map((item, idx) => {
                subTotal += parseInt(item.p);
                return `
                <div class="item-card">
                    <span class="remove-btn" onclick="removeItem(${idx})">×</span>
                    <img src="${item.i}">
                    <div class="item-info">
                        <h4>${item.n}</h4>
                        <p>Size: ${item.selSize} | Colour: ${item.selColor}</p>
                        <div class="item-price">₹${item.p}</div>
                    </div>
                </div>`;
            }).join('');

            // Shipping Logic: Under 1999 = ₹29 charge
            let ship = subTotal < 1999 ? 29 : 0;
            document.getElementById('subTotal').innerText = "₹" + subTotal;
            document.getElementById('shipCharge').innerText = ship === 0 ? "FREE" : "₹" + ship;
            document.getElementById('grandTotal').innerText = "₹" + (subTotal + ship);
        }

        function removeItem(idx) {
            let bag = JSON.parse(localStorage.getItem('lexBag')) || [];
            bag.splice(idx, 1);
            localStorage.setItem('lexBag', JSON.stringify(bag));
            loadBag();
        }

        function placeOrder() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            if(!name || !phone) { alert("Please fill details!"); return; }

            // Here we send data to Google Sheets
            alert("Order Placed Successfully! You will receive confirmation soon.");
            localStorage.removeItem('lexBag');
            window.location.href = "index.html";
        }

        window.onload = loadBag;
    </script>
</body>
</html>
