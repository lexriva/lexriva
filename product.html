<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lexriva | Product Details</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --cherry: #72001A; --gold: #D4AF37; --lavender: #F4EFFF; }
        body { font-family: 'Inter', sans-serif; margin: 0; background: var(--lavender); padding-bottom: 100px; }
        
        /* Image Slider */
        .img-container { width: 100%; height: 450px; background: #fff; position: relative; }
        #mainImg { width: 100%; height: 100%; object-fit: cover; }
        .thumb-bar { display: flex; gap: 10px; padding: 15px; overflow-x: auto; background: #fff; scrollbar-width: none; }
        .thumb { width: 60px; height: 60px; border-radius: 8px; border: 1.5px solid #eee; cursor: pointer; object-fit: cover; }
        .thumb.active { border-color: var(--cherry); }

        /* Product Info */
        .info-card { background: #fff; padding: 20px; border-radius: 30px 30px 0 0; margin-top: -20px; position: relative; }
        .p-name { font-family: 'Cinzel'; font-size: 20px; font-weight: 900; color: var(--cherry); }
        
        /* Price Section */
        .price-box { margin: 15px 0; }
        .old-price { text-decoration: line-through; color: #888; font-size: 16px; margin-right: 10px; }
        .new-price { font-size: 24px; font-weight: 800; color: #000; }
        
        /* Shipping & Policy */
        .policy-note { font-size: 11px; color: #555; background: #f9f9f9; padding: 10px; border-radius: 10px; margin: 15px 0; border-left: 3px solid var(--gold); }

        /* Options */
        .label { font-weight: 800; font-size: 12px; margin-bottom: 8px; display: block; }
        .select-box { width: 100%; padding: 12px; border-radius: 10px; border: 1px solid #ddd; margin-bottom: 20px; outline: none; }

        /* Floating Actions */
        .bottom-actions { position: fixed; bottom: 0; width: 100%; background: #fff; display: flex; padding: 15px; gap: 10px; box-sizing: border-box; border-top: 1px solid #eee; z-index: 1000; }
        .btn-cart { flex: 1; padding: 15px; border-radius: 30px; border: 1.5px solid var(--cherry); color: var(--cherry); font-weight: 800; background: #fff; }
        .btn-buy { flex: 1; padding: 15px; border-radius: 30px; background: var(--cherry); color: #fff; border: none; font-weight: 800; }
        .wish-btn { font-size: 22px; background: none; border: none; cursor: pointer; color: #ccc; }
        .wish-btn.active { color: red; }
    </style>
</head>
<body>

    <div class="img-container">
        <img id="mainImg" src="">
    </div>
    
    <div class="thumb-bar" id="thumbBar"></div>

    <div class="info-card">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div class="p-name" id="pName"></div>
            <button class="wish-btn" id="wishBtn" onclick="toggleWishlist()">â™¥</button>
        </div>

        <div class="price-box">
            <span class="old-price" id="oldPrice">â‚¹1999</span>
            <span class="new-price" id="newPrice"></span>
        </div>

        <div class="policy-note">
            ðŸšš 7-8 Days Delivery | <b>â‚¹29 Shipping</b> on orders below â‚¹1999 <br>
            ðŸ”„ 2 Days Exchange available after delivery
        </div>

        <label class="label">SELECT COLOUR</label>
        <select class="select-box" id="pColour"></select>

        <label class="label">SELECT SIZE</label>
        <select class="select-box" id="pSize"></select>

        <label class="label">DESCRIPTION</label>
        <p id="pDesc" style="font-size: 13px; color: #666; line-height: 1.6;"></p>
    </div>

    <div class="bottom-actions">
        <button class="btn-cart" onclick="addToBag()">ADD TO BAG</button>
        <button class="btn-buy" onclick="checkoutNow()">BUY NOW</button>
    </div>

    <script>
        const API = "https://script.google.com/macros/s/AKfycbyJbLc033WEF7htCF5LYhBF3jC-2YKhLV-SE-MsQYLVQR18ZQN_kWtDrd44EEzB7JB4/exec";
        const targetSheet = localStorage.getItem('targetSheet');
        const targetIdx = localStorage.getItem('targetIdx');

        async function loadProduct() {
            const res = await fetch(API);
            const data = await res.json();
            const p = data[targetSheet][targetIdx];
            window.currentProduct = p;

            // Images
            document.getElementById('mainImg').src = p.i;
            const imgs = [p.i, p.i2, p.i3].filter(x => x);
            document.getElementById('thumbBar').innerHTML = imgs.map((img, i) => 
                `<img src="${img}" class="thumb ${i===0?'active':''}" onclick="changeImg(this, '${img}')">`
            ).join('');

            // Details
            document.getElementById('pName').innerText = p.n;
            document.getElementById('newPrice').innerText = "â‚¹" + p.p;
            document.getElementById('pDesc').innerText = p.d;

            // Colours & Sizes
            document.getElementById('pColour').innerHTML = p.c.split(',').map(c => `<option>${c.trim()}</option>`).join('');
            document.getElementById('pSize').innerHTML = p.s.split(',').map(s => `<option>${s.trim()}</option>`).join('');
            
            checkWishlistStatus();
        }

        function changeImg(el, src) {
            document.getElementById('mainImg').src = src;
            document.querySelectorAll('.thumb').forEach(t => t.classList.remove('active'));
            el.classList.add('active');
        }

        function addToBag() {
            let bag = JSON.parse(localStorage.getItem('lexBag')) || [];
            bag.push({ ...window.currentProduct, selectedSize: document.getElementById('pSize').value });
            localStorage.setItem('lexBag', JSON.stringify(bag));
            alert("Added to Bag! Total items: " + bag.length);
        }

        function toggleWishlist() {
            let wish = JSON.parse(localStorage.getItem('lexWish')) || [];
            const btn = document.getElementById('wishBtn');
            // logic to add/remove and toggle class 'active'
            btn.classList.toggle('active');
            localStorage.setItem('lexWish', JSON.stringify(wish));
        }

        function checkoutNow() {
            addToBag();
            window.location.href = "checkout.html";
        }

        window.onload = loadProduct;
    </script>
</body>
</html>
