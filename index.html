<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Lexriva | Where Elegance Meets You</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700;900&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root{ --lavender:#F4EFFF; --cherry:#72001A; --gold:#D4AF37; --white:#ffffff; }
        body{font-family:'Inter',sans-serif;margin:0;background:var(--lavender);overflow-x:hidden}
        .page{display:none;max-width:500px;margin:0 auto;min-height:100vh;padding-bottom:100px;background:var(--lavender)}
        .active{display:block}
        .header{background:#fff;padding:20px;text-align:center;position:sticky;top:0;z-index:1000}
        .logo{font-family:'Cinzel';font-size:26px;letter-spacing:6px;font-weight:900;color:var(--cherry)}
        .search-wrapper { padding: 5px 20px 15px; background: #fff; border-bottom: 1px solid #eee; }
        .search-input { width: 100%; padding: 12px 20px; border-radius: 25px; border: 1px solid #eee; background: #f9f9f9; outline: none; font-size: 13px; box-sizing: border-box; }
        .section-h{padding:15px;font-size:11px;font-weight:800;text-transform:uppercase;color:var(--cherry); letter-spacing:1.5px;}
        .h-scroll{display:flex;overflow-x:auto;gap:15px;padding:0 15px 15px;scrollbar-width:none}
        .scroll-item{min-width:140px;text-align:center;background:#fff;padding:10px;border-radius:20px;box-shadow:0 10px 20px rgba(0,0,0,0.05); position:relative;}
        .scroll-item img{width:120px;height:160px;border-radius:15px;object-fit:cover}

        /* Wishlist Heart */
        .wish-btn{position:absolute; top:15px; right:15px; background:white; border-radius:50%; width:28px; height:28px; display:flex; align-items:center; justify-content:center; border:none; color:#ccc; cursor:pointer; font-size:16px; box-shadow:0 2px 5px rgba(0,0,0,0.1); z-index:10;}
        .wish-btn.active{color:red}

        .cat-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:15px}
        .cat-card{position:relative;border-radius:20px;overflow:hidden;height:180px;box-shadow:0 8px 15px rgba(0,0,0,0.05); cursor:pointer}
        .cat-card img{width:100%;height:100%;object-fit:cover}
        .cat-label{position:absolute;bottom:10px;left:10px;color:#fff;font-size:10px;font-weight:800;text-shadow:0 2px 4px rgba(0,0,0,0.5)}

        .sub-grid{display:grid;grid-template-columns:repeat(3,1fr);background:var(--lavender);padding:10px 0;}
        .sub-item{padding:15px 5px;text-align:center;display:flex;flex-direction:column;align-items:center; cursor:pointer}
        .sub-item img{width:80px;height:80px;border-radius:50%;object-fit:cover;margin-bottom:8px;box-shadow:0 4px 10px rgba(0,0,0,0.1)}

        .cherry-box{background:var(--cherry); color:var(--gold); border-radius:120px 120px 10px 10px; margin:15px auto; width:100px; height:150px; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; font-family:'Cinzel'; border:2px solid var(--gold); box-shadow:0 10px 25px rgba(114,0,26,0.3)}

        .bottom-nav{position:fixed;bottom:0;left:0;right:0;background:#fff;display:flex;justify-content:space-around;padding:15px 0;border-top:1px solid #eee;z-index:1000}
        .nav-btn{font-size:9px;font-weight:800;color:#999;cursor:pointer;text-align:center; text-decoration:none;}
    </style>
</head>
<body>

<div class="header"><div class="logo">LEXRIVA</div></div>
<div class="search-wrapper"><input type="text" id="mainSearch" class="search-input" placeholder="Search Jewelry, Suits, Bags..." oninput="filterSearch()"></div>

<div id="h-pg" class="page active">
    <div style="padding:0 15px"><img src="main_banner.jpg" style="width:100%;border-radius:25px" onerror="this.src='https://via.placeholder.com/500x250?text=LEXRIVA+BANNER'"></div>
    <div class="section-h">üåô THE EID EDIT</div><div id="eid-scroll" class="h-scroll"></div>
    <div class="section-h">üî• BESTSELLERS</div><div id="l-scroll" class="h-scroll"></div>
    
    <div class="section-h">üëó CURATED CATEGORIES</div>
    <div class="cat-grid">
        <div class="cat-card" onclick="openSub('western')"><img src="cat_western.jpg"><div class="cat-label">WESTERN WEAR</div></div>
        <div class="cat-card" onclick="openSub('ethnic')"><img src="cat_ethnic.jpg"><div class="cat-label">ETHNIC WEAR</div></div>
        <div class="cat-card" onclick="openSub('makeup_cat')"><img src="cat_makeup.jpg"><div class="cat-label">MAKEUP & CARE</div></div>
        <div class="cat-card" onclick="openSub('jewellery_master')"><img src="cat_jewel.jpg"><div class="cat-label">FINE JEWELLERY</div></div>
    </div>
</div>

<div id="s-pg" class="page">
    <div style="padding:20px;font-weight:800;color:var(--cherry);cursor:pointer" onclick="showPg('h-pg')">‚Üê BACK</div>
    <div id="s-banner" style="width:100%;height:220px"></div>
    <div id="s-grid" class="sub-grid"></div>
</div>

<div id="p-list-pg" class="page">
    <div style="padding:20px;font-weight:800;color:var(--cherry);cursor:pointer" onclick="showPg('s-pg')">‚Üê BACK</div>
    <div class="section-h" id="p-list-title">COLLECTION</div>
    <div id="p-list-grid" class="cat-grid"></div>
</div>

<div class="bottom-nav">
    <div class="nav-btn" onclick="showPg('h-pg')">üè†<br>HOME</div>
    <div class="nav-btn" onclick="showPg('h-pg')">üëó<br>SHOP</div>
    <div class="nav-btn">üíñ<br>WISHLIST</div>
    <div class="nav-btn">üõçÔ∏è<br>BAG</div>
</div>

<script>
const ADMIN_URL="https://script.google.com/macros/s/AKfycbyJbLc033WEF7htCF5LYhBF3jC-2YKhLV-SE-MsQYLVQR18ZQN_kWtDrd44EEzB7JB4/exec";
let store={}; 
let wishlist = JSON.parse(localStorage.getItem('lexWish')) || [];

const subMap={
    'western':['Dresses','Tops','Jeans','T-shirt','LEXRIVA','Jumpsuit','Co-ords','Sleep Wear'],
    'ethnic':['Saree','Kurtis','Dress Material','Lehengas','LEXRIVA','Gowns','Suits'],
    'makeup_cat':['Lipstick','Lip Gloss','Foundation','Compact','LEXRIVA','Concealer','Eyeliner'],
    'jewellery_master':['Minimal','Necklace Set','Earrings','Maangtika','LEXRIVA','Rings','Bridal','Kashmiri Earrings','Jhumka','Korean Earrings']
};

async function init(){ 
    try {
        const r = await fetch(ADMIN_URL); 
        store = await r.json(); 
        renderH();
    } catch(e) { console.log("Init Error"); }
}

function renderH(data=store){
    // Smart Header Mapping (Position based fallback)
    const renderSection = (items) => (items||[]).map(p => {
        const vals = Object.values(p);
        const name = p.Name || p.n || vals[0];
        const price = p.Price || p.p || vals[1];
        const img = p['Image 1'] || p.i || vals[2];
        const isWished = wishlist.find(x => x.n === name) ? 'active' : '';
        
        return `<div class="scroll-item">
            <button class="wish-btn ${isWished}">‚ô•</button>
            <div onclick="alert('Opening: ${name}')">
                <img src="${img}">
                <p style="font-size:10px;font-weight:700; margin:5px 0 0">‚Çπ${price}</p>
            </div>
        </div>`;
    }).join('');

    document.getElementById('eid-scroll').innerHTML = renderSection(data.Eid || data.eid);
    document.getElementById('l-scroll').innerHTML = renderSection(data.Bestseller || data.bestseller || data.latest);
}

function openSub(k){
    showPg('s-pg');
    document.getElementById('s-banner').innerHTML=`<img src="${k}_banner.jpg" style="width:100%;height:100%;object-fit:cover" onerror="this.src='https://via.placeholder.com/500x200?text=${k.toUpperCase()}'">`;
    let h=""; 
    (subMap[k]||[]).forEach(n=>{
        if(n === 'LEXRIVA') h+=`<div class="sub-item"><div class="cherry-box"><span style="font-size:8px">ESTD</span><br><span style="font-size:12px; font-weight:900">LEXRIVA</span></div></div>`;
        else h+=`<div class="sub-item" onclick="openSubProducts('${n}')"><img src="${n.toLowerCase().replace(/ /g,'_')}.jpg" onerror="this.src='https://via.placeholder.com/80?text=${n}'"><p style="font-size:9px;font-weight:700;text-transform:uppercase">${n}</p></div>`;
    });
    document.getElementById('s-grid').innerHTML=h;
}

function openSubProducts(catName){
    showPg('p-list-pg'); 
    document.getElementById('p-list-title').innerText = catName.toUpperCase();
    // Filter from all sheets
    let filtered = [];
    Object.values(store).forEach(sheet => {
        if(Array.isArray(sheet)) {
            sheet.forEach(p => {
                const pSub = (p.subCat || p.Category || "").toLowerCase();
                if(pSub === catName.toLowerCase()) filtered.push(p);
            });
        }
    });
    
    document.getElementById('p-list-grid').innerHTML = filtered.map(p => {
        const vals = Object.values(p);
        const price = p.Price || p.p || vals[1];
        const img = p['Image 1'] || p.i || vals[2];
        return `<div class="cat-card"><img src="${img}"><div class="cat-label">‚Çπ${price}</div></div>`;
    }).join('') || "<p style='padding:20px'>Coming Soon...</p>";
}

function showPg(id){
    document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
    document.getElementById(id).classList.add('active');
    window.scrollTo(0,0);
}

window.onload = init;
</script>
</body>
</html>
