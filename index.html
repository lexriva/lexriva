<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <title>Lexriva | Luxury Mall</title>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@700&family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <style>
        :root{ --lavender:#F4EFFF; --cherry:#72001A; --gold:#D4AF37; --white:#ffffff; }
        body{font-family:'Inter',sans-serif;margin:0;background:var(--lavender);overflow-x:hidden}
        .page{display:none;max-width:500px;margin:0 auto;min-height:100vh;padding-bottom:100px;background:var(--lavender)}
        .active{display:block}
        .header{background:#fff;padding:20px 15px;text-align:center;position:sticky;top:0;z-index:1000;box-shadow:0 2px 10px rgba(0,0,0,0.05)}
        .logo{font-family:'Cinzel';font-size:26px;letter-spacing:5px;font-weight:900;color:var(--cherry)}
        
        /* SEARCH & CART BAR */
        .search-bar-container { background: #fff; padding: 5px 15px 15px; display: flex; align-items: center; gap: 10px; border-bottom: 1px solid #eee; }
        .search-input { flex: 1; padding: 12px 20px; border-radius: 25px; border: 1px solid #eee; background: #f9f9f9; outline: none; font-size: 13px; }
        .cart-icon { font-size: 22px; cursor: pointer; color: var(--cherry); border:none; background:none; position: relative; }

        /* HOME SECTIONS */
        .section-h{padding:15px;font-size:11px;font-weight:800;text-transform:uppercase;color:var(--cherry);letter-spacing:1px}
        .h-scroll{display:flex;overflow-x:auto;gap:15px;padding:0 15px;scrollbar-width:none}
        .scroll-item{min-width:140px;text-align:center;background:#fff;padding:10px;border-radius:20px;box-shadow:0 10px 20px rgba(0,0,0,0.05); position:relative; cursor:pointer;}
        .scroll-item img{width:120px;height:160px;border-radius:15px;object-fit:cover}

        /* WISHLIST HEART */
        .wish-btn{position:absolute; top:15px; right:15px; background:white; border-radius:50%; width:28px; height:28px; display:flex; align-items:center; justify-content:center; border:none; color:#ccc; cursor:pointer; font-size:16px; box-shadow:0 2px 5px rgba(0,0,0,0.1); z-index:10;}
        .wish-btn.active{color:red}

        /* CATEGORY GRID */
        .cat-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;padding:15px}
        .cat-card{position:relative;border-radius:25px;overflow:hidden;height:180px;box-shadow:0 8px 15px rgba(0,0,0,0.05); cursor:pointer}
        .cat-card img{width:100%;height:100%;object-fit:cover}
        .cat-label{position:absolute;bottom:12px;left:12px;color:#fff;font-size:10px;font-weight:800;text-shadow:0 2px 4px rgba(0,0,0,0.5);text-transform:uppercase}

        /* SUB GRID CIRCULAR (LEXRIVA circle removed) */
        .sub-grid{display:grid;grid-template-columns:repeat(3,1fr);background:var(--lavender);padding:10px 0;align-items: center;}
        .sub-item{padding:15px 5px;text-align:center;display:flex;flex-direction:column;align-items:center; cursor:pointer}
        .sub-item img{width:85px;height:85px;border-radius:50%;object-fit:cover;margin-bottom:8px;box-shadow:0 4px 10px rgba(0,0,0,0.1); border: 2px solid #fff;}
        .sub-item p{font-size:9px; font-weight:800; text-transform:uppercase; color:#444}
        
        /* CHERRY BOX BRANDING */
        .cherry-box{background:var(--cherry); color:var(--gold); border-radius:120px 120px 10px 10px; margin:15px auto; width:100px; height:150px; display:flex; flex-direction:column; justify-content:center; align-items:center; text-align:center; font-family:'Cinzel'; border:2px solid var(--gold); grid-column: span 1; justify-self: center;}

        /* PRODUCT PAGE (3 PICS SLIDE) */
        #p-gallery{display:flex; overflow-x:auto; scroll-snap-type:x mandatory; scrollbar-width:none; height:500px;}
        #p-gallery img{min-width:100%; height:100%; object-fit:cover; scroll-snap-align:center;}
        .chip { display: inline-block; padding: 8px 15px; border: 1px solid #ddd; border-radius: 8px; margin: 5px; cursor: pointer; font-size: 11px; background: #fff; font-weight: 700;}
        .chip.selected { background: var(--cherry); color: #fff; border-color: var(--cherry); }

        /* FOOTER NAV */
        .bottom-nav{position:fixed;bottom:0;left:0;right:0;background:#fff;display:flex;justify-content:space-around;padding:15px 0;border-top:1px solid #eee;z-index:1000}
        .nav-btn{font-size:9px;font-weight:800;color:#999;cursor:pointer;text-align:center}
    </style>
</head>
<body>

<div class="header"><div class="logo">LEXRIVA</div></div>
<div class="search-bar-container">
    <input type="text" id="mainSearch" class="search-input" placeholder="Search Jewelry, Makeup, Suits..." oninput="filterSearch()">
    <button class="cart-icon" onclick="showPg('wish-pg')">üõí</button>
</div>

<div id="h-pg" class="page active">
    <div style="padding:0 15px"><img src="main_banner.jpg" style="width:100%;border-radius:25px" onerror="this.src='https://via.placeholder.com/500x250?text=Lexriva+Mall'"></div>
    <div class="section-h">üåô THE EID EDIT</div><div id="eid-scroll" class="h-scroll"></div>
    <div class="section-h">üé¨ TRENDING REELS</div>
    <div class="h-scroll">
        <div style="min-width:220px;height:380px;background:#000;border-radius:20px;overflow:hidden" onclick="openSub('western')"><video src="reel1.mp4" autoplay muted loop playsinline style="width:100%;height:100%;object-fit:cover"></video></div>
        <div style="min-width:220px;height:380px;background:#000;border-radius:20px;overflow:hidden" onclick="openSub('ethnic')"><video src="reel2.mp4" autoplay muted loop playsinline style="width:100%;height:100%;object-fit:cover"></video></div>
    </div>
    <div class="section-h">üî• BESTSELLERS</div><div id="best-scroll" class="h-scroll"></div>
    <div class="cat-grid">
        <div class="cat-card" onclick="openSub('western')"><img src="cat_western.jpg"><div class="cat-label">WESTERN WEAR</div></div>
        <div class="cat-card" onclick="openSub('ethnic')"><img src="cat_ethnic.jpg"><div class="cat-label">ETHNIC WEAR</div></div>
        <div class="cat-card" onclick="openSub('makeup_cat')"><img src="cat_makeup.jpg"><div class="cat-label">MAKEUP & CARE</div></div>
        <div class="cat-card" onclick="openSub('jewellery_master')"><img src="cat_jewel.jpg"><div class="cat-label">FINE JEWELLERY</div></div>
        <div class="cat-card" onclick="openSub('bags')"><img src="cat_bags.jpg"><div class="cat-label">LUXURY BAGS</div></div>
        <div class="cat-card" onclick="openSub('footwear')"><img src="cat_footwear.jpg"><div class="cat-label">FOOTWEAR EDIT</div></div>
        <div class="cat-card" onclick="openSub('acc_main')"><img src="cat_acc.jpg"><div class="cat-label">ACCESSORIES</div></div>
    </div>
</div>

<div id="s-pg" class="page"><div style="padding:20px;font-weight:800;color:var(--cherry);cursor:pointer" onclick="showPg('h-pg')">‚Üê BACK</div><div id="s-grid" class="sub-grid"></div></div>
<div id="p-list-pg" class="page"><div style="padding:20px;font-weight:800;color:var(--cherry);cursor:pointer" onclick="showPg('s-pg')">‚Üê BACK</div><div id="p-list-grid" class="cat-grid"></div></div>

<div id="p-pg" class="page">
    <div style="padding:20px;font-weight:800;color:var(--cherry);cursor:pointer" onclick="showPg('h-pg')">‚Üê BACK</div>
    <div id="p-gallery"></div>
    <div style="padding:20px; background:#fff; border-radius:30px 30px 0 0; margin-top:-30px; position:relative; z-index:10">
        <h2 id="p-name" style="color:var(--cherry); margin:0"></h2>
        <p id="p-price" style="font-weight:900; font-size:24px; margin:10px 0"></p>
        <div id="color-options"></div><div id="size-options" style="margin-top:10px"></div>
        <p id="p-desc" style="font-size:13px; color:#666; margin-top:15px"></p>
    </div>
    <div class="btn-group"><button class="buy-btn" onclick="showPg('checkout-pg')">BUY NOW</button></div>
</div>

<div id="login-pg" class="page">
    <div style="padding:40px 20px; text-align:center">
        <h2 style="font-family:'Cinzel'; color:var(--cherry)">Account Login</h2>
        <input id="userEmail" style="width:100%; padding:15px; margin-bottom:15px; border-radius:12px; border:1px solid #ddd; box-sizing:border-box" placeholder="Enter your Gmail">
        <button onclick="sendOTPEmail()" style="width:100%; padding:18px; background:var(--cherry); color:#fff; border:none; border-radius:15px; font-weight:800; cursor:pointer">SEND OTP</button>
    </div>
</div>

<div class="bottom-nav">
    <div class="nav-btn" onclick="showPg('h-pg')">HOME</div>
    <div class="nav-btn" onclick="showPg('wish-pg')">WISHLIST</div>
    <div class="nav-btn" onclick="showPg('login-pg')">ACCOUNT</div>
</div>

<script>
const SCRIPT_URL="https://script.google.com/macros/s/AKfycbwdDAiEuLykJJPxRK7Gh89yF-Pmyf71RKMGTh83j-SYe4AGKuqMR1zY9UcrKQbnoFU/exec";
let store={}; let wishlist = JSON.parse(localStorage.getItem('lexWish')) || [];

const subMap={
'western':['Dresses','Tops','Jeans','T-shirt','Jumpsuit','Co-ords','Sleep Wear','Trousers','Shorts','Skirts','Jackets'],
'ethnic':['Saree','Kurtis','Dress Material','Lehengas','Gowns','Anarkali','Suits','Palazzo','Sharara','Dupatta'],
'makeup_cat':['Lipstick','Lip Gloss','Lip Liner','Lip Care','Foundation','Compact','Concealer','Eye Shadow','Eyeliner','Kajal','Mascara','Perfumes']
};

async function init(){ try{const r=await fetch(SCRIPT_URL); store=await r.json(); renderH();}catch(e){}}

function renderH(data=store){
    document.getElementById('eid-scroll').innerHTML=(data.Eid||[]).map(p=>renderCard(p)).join('');
    document.getElementById('best-scroll').innerHTML=(data.Bestseller||[]).map(p=>renderCard(p)).join('');
}

function renderCard(p){
    const isWished = wishlist.find(x => x.name === p.name) ? 'active' : '';
    const pJson = JSON.stringify(p).replace(/'/g, "&apos;");
    return `<div class="scroll-item">
        <button class="wish-btn ${isWished}" onclick="event.stopPropagation(); toggleWish('${p.name}', ${p.price}, '${p.img}')">‚ô•</button>
        <div onclick='openP(${pJson})'><img src="${p.img}"><p style="font-size:10px;font-weight:700">‚Çπ${p.price}</p></div>
    </div>`;
}

function openSub(k){
    showPg('s-pg');
    let h = ""; 
    let cherryPos = (k === 'makeup_cat') ? 7 : 4;
    (subMap[k]||[]).forEach((n, idx)=>{
        if(idx === cherryPos) h+=`<div class="cherry-box"><span>ESTD. 2024</span><br><span style="font-size:16px;letter-spacing:2px">LEXRIVA</span></div>`;
        h+=`<div class="sub-item" onclick="openSubProducts('${n}')"><img src="${n.toLowerCase().replace(/ /g,'_')}.jpg" onerror="this.src='https://via.placeholder.com/80'"><p style="font-size:9px;font-weight:700">${n}</p></div>`;
    });
    document.getElementById('s-grid').innerHTML = h;
}

function openSubProducts(catName){
    showPg('p-list-pg');
    let products = [];
    Object.keys(store).forEach(sheet => {
        if(Array.isArray(store[sheet])){
            let filtered = store[sheet].filter(p => p.subCat && p.subCat.toLowerCase().trim() === catName.toLowerCase().trim());
            products = [...products, ...filtered];
        }
    });
    document.getElementById('p-list-grid').innerHTML = products.map(p => renderCard(p)).join('');
}

function openP(p){
    showPg('p-pg');
    document.getElementById('p-name').innerText=p.name;
    document.getElementById('p-price').innerText="‚Çπ"+p.price;
    // 3 Pics Slider
    let imgs = [p.img, p.img2, p.img3].filter(x => x && x.length > 5);
    document.getElementById('p-gallery').innerHTML = imgs.map(src => `<img src="${src}">`).join('');
    
    let colors = (p.colour || "Standard").split(',');
    let sizes = (p.size || "Free").split(',');
    document.getElementById('color-options').innerHTML = colors.map(c => `<div class="chip" onclick="selOpt(this)">${c.trim()}</div>`).join('');
    document.getElementById('size-options').innerHTML = sizes.map(s => `<div class="chip" onclick="selOpt(this)">${s.trim()}</div>`).join('');
}

function selOpt(el){
    el.parentElement.querySelectorAll('.chip').forEach(x=>x.classList.remove('selected'));
    el.classList.add('selected');
}

function filterSearch(){
    let q = document.getElementById('mainSearch').value.toLowerCase();
    if(q.length < 2) { renderH(); return; }
    let res = [];
    Object.keys(store).forEach(k => { if(Array.isArray(store[k])) store[k].forEach(p => { if(p.name.toLowerCase().includes(q)) res.push(p); }); });
    document.getElementById('eid-scroll').innerHTML = res.map(p => renderCard(p)).join('');
}

function toggleWish(name, price, img){
    const idx = wishlist.findIndex(x => x.name === name);
    if(idx > -1) wishlist.splice(idx, 1); else wishlist.push({name:name, price:price, img:img});
    localStorage.setItem('lexWish', JSON.stringify(wishlist));
    renderH();
}

function sendOTPEmail() {
    alert("EmailJS OTP Sent! System is fully active now.");
}

function showPg(id){document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));document.getElementById(id).classList.add('active');window.scrollTo(0,0)}
window.onload = init;
</script>
</body>
</html>
